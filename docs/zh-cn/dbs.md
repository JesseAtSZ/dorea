# 多库管理

在 `Dorea` 中，您可以创建多个小的仓库「 类似 Redis 中的 `1~12` 以及 Mongo 中的 `Collection` 」

## 启动预加载

在配置文件 `config.toml` 中您可以定义最多四个预加载库，可以把最常用和数据量最大的库列入其中。

```
pre_load_group = ["default", "system"] # 这是 Dorea 默认的预加载信息
```

在系统启动时，预加载的库会耗费程序启动时间来将索引载入内存。

```
[INFO] 2021-12-27T20:42:27.424419+08:00 - index information loaded from "default" [0].
[INFO] 2021-12-27T20:42:27.426828+08:00 - index information loaded from "system" [0].
```

## 预留库名

!> 请勿随意使用以下列表中的库用于数据存储，出现问题后果自负！

### system

系统数据存储库，在系统运行期间会向内写入大量的运行数据，所以请勿往内写入任何个人数据。

### egg

请原谅我的私心QWQ，这个库我会用来偷偷丢一些小彩蛋（其他地方不会有任何影响运行的彩蛋，但是这是我最后的底线！）

也欢迎各位贡献者往里面写入属于自己的彩蛋！（如果您介意这个问题，请您Fork一份代码并删除相关彩蛋代码）

在正常使用的情况下，也请不要加载这个库，因为它拥有大量毫无意义的数据与功能！


### dorea

以 `dorea` 命名的数据库也请不要随意使用（后续会出相关功能）

## 切换库

使用 `select` 命令可以直接切换当前使用的仓库。

如果您尝试切换到一个未加载到内存中的库时，系统会当场进行加载。（数据量过大会有延迟）

解决延迟的最好方法就是：先使用 `db preload {db_name}` 后，过一段时间再进行 `select {db_name}`

这样你可以在中间的时间内做点别的事情！

## 卸载库

使用 `db unload {db_name}` 手动卸载一个内存中的库（如果一个库被使用中则无法进行卸载）

不同于上方的手动卸载，系统也会根据权重进行 [自动卸载服务](https://mrxzx.info/2021/12/23/dorea-design-doc/#索引淘汰机制)

## 预载库

使用 `db preload {db_name}` 进行预载，预载期间不影响命令的使用（系统会开启单独的进程进行加载）